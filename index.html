<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Ma'lumotlarni O'qish va Ishlov Berish</title>
  <!-- PDF.js kutubxonasini ulash -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #pdfContent { white-space: pre-wrap; margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>PDF Ma'lumotlarni O'qish va Ishlov Berish</h1>
  <p>PDF faylni yuklash va undagi savollarni ajratib olish uchun "PDF Yuklash" tugmasini bosing.</p>
  <button id="loadPdf">PDF Yuklash</button>
  <div id="pdfContent"></div>

  <script>
    // GitHub repozitoriyangizdagi PDF faylning raw URL manzili.
    // Masalan: https://raw.githubusercontent.com/username/repo/main/tests.pdf
    const pdfUrl = 'https://raw.githubusercontent.com/username/repo/main/tests.pdf';

    const loadPdfBtn = document.getElementById('loadPdf');
    const pdfContentDiv = document.getElementById('pdfContent');

    loadPdfBtn.addEventListener('click', () => {
      loadPdf();
    });

    async function loadPdf() {
      try {
        // PDF faylni yuklash
        const loadingTask = pdfjsLib.getDocument(pdfUrl);
        const pdf = await loadingTask.promise;
        let fullText = '';

        // Har bir sahifadan matn ajratib olish
        for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
          const page = await pdf.getPage(pageNum);
          const textContent = await page.getTextContent();
          const pageText = textContent.items.map(item => item.str).join(' ');
          fullText += pageText + '\n\n';
        }

        // Hamma matnni ekranga chiqarish
        pdfContentDiv.textContent = fullText;

        // Savollarni ajratib olish funksiyasini chaqirish
        processQuestions(fullText);
      } catch (error) {
        console.error('PDF yuklashda xatolik:', error);
        pdfContentDiv.textContent = 'PDF yuklashda xatolik yuz berdi.';
      }
    }

    function processQuestions(pdfText) {
      // Misol: Agar savollar "Q:" bilan boshlansa
      // Savollarni ajratish uchun oddiy regex: savollar "Q:" bilan boshlanib keyingi "Q:" yoki fayl oxirigacha davom etadi.
      const questionPattern = /Q:\s*(.*?)\s*(?=Q:|$)/gs;
      const questions = pdfText.match(questionPattern);

      if (questions && questions.length > 0) {
        console.log('Topilgan savollar:', questions);
        // Masalan, savollar ro'yxatini ekranga chiqarish:
        const questionsList = document.createElement('ol');
        questions.forEach(q => {
          const listItem = document.createElement('li');
          listItem.textContent = q.trim();
          questionsList.appendChild(listItem);
        });
        pdfContentDiv.appendChild(questionsList);
      } else {
        console.log('Hech qanday savol topilmadi.');
        pdfContentDiv.textContent += '\nHech qanday savol topilmadi.';
      }
    }
  </script>
</body>
</html>
